{
  "openapi": "3.0.3",
  "info": {
    "title": "api",
    "description": "",
    "license": {
      "name": ""
    },
    "version": "0.1.0"
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "Dev server"
    },
    {
      "url": "https://hack.ethz.ch",
      "description": "Prod server"
    }
  ],
  "paths": {
    "/api/events": {
      "get": {
        "tags": ["crate::routers::events"],
        "operationId": "get_events",
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EventDTO"
                  }
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/events/roles": {
      "get": {
        "tags": ["crate::routers::events"],
        "operationId": "get_events_roles",
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "array",
                    "items": {
                      "$ref": "#/components/schemas/EventRole"
                    },
                    "uniqueItems": true
                  }
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/events/{event_id}": {
      "get": {
        "tags": ["crate::routers::events"],
        "operationId": "get_event",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventDTO"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["crate::routers::events"],
        "operationId": "patch_event",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EventForPatch"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventDTO"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/events/{event_id}/aggregate": {
      "get": {
        "tags": ["crate::routers::events"],
        "operationId": "get_aggregate_status",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AggregatorStatus"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["crate::routers::events"],
        "operationId": "aggregate_action",
        "parameters": [
          {
            "name": "aggregate_action",
            "in": "query",
            "description": "Action to perform on the aggregator for this event",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/AggregationAction"
            }
          },
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AggregatorStatus"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/events/{event_id}/invite": {
      "post": {
        "tags": ["crate::routers::events"],
        "operationId": "invite_users",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InviteUsersDTO"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AffectedRowsDTO"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/events/{event_id}/roles": {
      "get": {
        "tags": ["crate::routers::events"],
        "operationId": "get_event_roles",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EventRole"
                  },
                  "uniqueItems": true
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["crate::routers::events"],
        "operationId": "put_event_roles",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EventRole"
                  },
                  "uniqueItems": true
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AffectedRowsDTO"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["crate::routers::events"],
        "operationId": "delete_event_roles",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EventRole"
                  },
                  "uniqueItems": true
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AffectedRowsDTO"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/sidequests": {
      "get": {
        "tags": ["crate::routers::sidequests"],
        "operationId": "get_sidequests",
        "parameters": [
          {
            "name": "event_id",
            "in": "query",
            "description": "The ID of the event to get sidequests for",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/SidequestDTO"
                  }
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["crate::routers::sidequests"],
        "operationId": "post_sidequests",
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSidequestDTO"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "integer",
                  "format": "int64",
                  "minimum": 0
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/sidequests/leaderboard": {
      "get": {
        "tags": ["crate::routers::sidequests"],
        "operationId": "get_team_leaderboard",
        "parameters": [
          {
            "name": "event_id",
            "in": "query",
            "description": "The Event ID to get the leaderboard for",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FullInfoTeamEntryForLeaderboard"
                  }
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/sidequests/leaderboard/timeline": {
      "get": {
        "tags": ["crate::routers::sidequests"],
        "operationId": "get_leaderboard_timeline",
        "parameters": [
          {
            "name": "event_id",
            "in": "query",
            "description": "The Event ID to get the leaderboard for",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "before",
            "in": "query",
            "description": "Only return entries before this time",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "after",
            "in": "query",
            "description": "Only return entries after this time",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TimelineData"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/sidequests/{sidequest_id}": {
      "get": {
        "tags": ["crate::routers::sidequests"],
        "operationId": "get_sidequest",
        "parameters": [
          {
            "name": "sidequest_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SidequestDTO"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["crate::routers::sidequests"],
        "operationId": "patch_sidequests",
        "parameters": [
          {
            "name": "sidequest_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SidequestForPatch"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SidequestDTO"
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/sidequests/{sidequest_id}/attempts": {
      "post": {
        "tags": ["crate::routers::sidequests"],
        "operationId": "post_sidequests_attempts",
        "parameters": [
          {
            "name": "sidequest_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AttemptForCreate"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "integer",
                  "format": "int64",
                  "minimum": 0
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    },
    "/api/sidequests/{sidequest_id}/leaderboard": {
      "get": {
        "tags": ["crate::routers::sidequests"],
        "operationId": "get_leaderboard",
        "parameters": [
          {
            "name": "sidequest_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FullInfoSidequestEntryForLeaderboard"
                  }
                }
              }
            }
          },
          "500": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicError"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AffectedRowsDTO": {
        "type": "object",
        "required": ["affected_rows"],
        "properties": {
          "affected_rows": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          }
        }
      },
      "AggregateActionQuery": {
        "type": "object",
        "required": ["aggregate_action"],
        "properties": {
          "aggregate_action": {
            "$ref": "#/components/schemas/AggregationAction"
          }
        }
      },
      "AggregationAction": {
        "type": "string",
        "enum": ["Start", "Stop"]
      },
      "AggregatorStatus": {
        "type": "object",
        "required": ["event_id", "status"],
        "properties": {
          "event_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "$ref": "#/components/schemas/LoopStatus"
          }
        }
      },
      "AttemptForCreate": {
        "type": "object",
        "required": ["user_id", "result"],
        "properties": {
          "result": {
            "type": "number",
            "format": "double"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "CreateSidequestDTO": {
        "type": "object",
        "required": [
          "event_id",
          "name",
          "description",
          "is_higher_result_better"
        ],
        "properties": {
          "description": {
            "type": "string"
          },
          "event_id": {
            "type": "string",
            "format": "uuid"
          },
          "is_higher_result_better": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "EventDTO": {
        "type": "object",
        "required": [
          "id",
          "name",
          "slug",
          "start",
          "end",
          "max_team_size",
          "is_feedback_visible",
          "visibility",
          "phase"
        ],
        "properties": {
          "end": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_feedback_visible": {
            "type": "boolean"
          },
          "max_team_size": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "name": {
            "type": "string"
          },
          "phase": {
            "$ref": "#/components/schemas/EventPhase"
          },
          "slug": {
            "type": "string"
          },
          "start": {
            "type": "string",
            "format": "date-time"
          },
          "visibility": {
            "$ref": "#/components/schemas/EventVisibility"
          }
        }
      },
      "EventForCreate": {
        "type": "object",
        "required": ["name", "start", "end", "max_team_size"],
        "properties": {
          "end": {
            "type": "string",
            "format": "date-time"
          },
          "max_team_size": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "name": {
            "type": "string"
          },
          "start": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "EventForPatch": {
        "type": "object",
        "properties": {
          "end": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "is_feedback_visible": {
            "type": "boolean",
            "nullable": true
          },
          "max_team_size": {
            "type": "integer",
            "format": "int32",
            "nullable": true,
            "minimum": 0
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "phase": {
            "allOf": [
              {
                "$ref": "#/components/schemas/EventPhase"
              }
            ],
            "nullable": true
          },
          "start": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "visibility": {
            "allOf": [
              {
                "$ref": "#/components/schemas/EventVisibility"
              }
            ],
            "nullable": true
          }
        }
      },
      "EventIdQuery": {
        "type": "object",
        "required": ["event_id"],
        "properties": {
          "event_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "EventLeaderboardTimelineQuery": {
        "type": "object",
        "required": ["event_id"],
        "properties": {
          "after": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "before": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "event_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "EventPhase": {
        "type": "string",
        "enum": ["Grading", "Hacking", "Readonly", "Registration"]
      },
      "EventRole": {
        "type": "string",
        "enum": [
          "Admin",
          "Mentor",
          "Participant",
          "SidequestMaster",
          "Stakeholder"
        ]
      },
      "EventVisibility": {
        "type": "string",
        "enum": ["Private", "Public", "Restricted"]
      },
      "FullInfoSidequestEntryForLeaderboard": {
        "type": "object",
        "required": [
          "user_name",
          "user_id",
          "group_name",
          "group_id",
          "result",
          "points"
        ],
        "properties": {
          "group_id": {
            "type": "string",
            "format": "uuid"
          },
          "group_name": {
            "type": "string"
          },
          "points": {
            "type": "integer",
            "format": "int64"
          },
          "result": {
            "type": "number",
            "format": "double"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          },
          "user_name": {
            "type": "string"
          }
        }
      },
      "FullInfoTeamEntryForLeaderboard": {
        "type": "object",
        "required": ["group_name", "group_id", "result", "rank"],
        "properties": {
          "group_id": {
            "type": "string",
            "format": "uuid"
          },
          "group_name": {
            "type": "string"
          },
          "rank": {
            "type": "integer",
            "format": "int64"
          },
          "result": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "InviteUsersDTO": {
        "type": "object",
        "required": ["users", "default_roles"],
        "properties": {
          "default_roles": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EventRole"
            }
          },
          "users": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UserForCreate"
            }
          }
        }
      },
      "LoopStatus": {
        "type": "string",
        "enum": ["NonExisting", "Running", "Exited"]
      },
      "PublicError": {
        "type": "object",
        "required": ["status", "message"],
        "properties": {
          "message": {
            "type": "string"
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "SidequestDTO": {
        "type": "object",
        "required": [
          "id",
          "event_id",
          "name",
          "slug",
          "description",
          "is_higher_result_better"
        ],
        "properties": {
          "description": {
            "type": "string"
          },
          "event_id": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_higher_result_better": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          }
        }
      },
      "SidequestEntryForLeaderboard": {
        "type": "object",
        "required": ["user_id", "result"],
        "properties": {
          "points": {
            "type": "integer",
            "format": "int64",
            "nullable": true
          },
          "result": {
            "type": "number",
            "format": "double"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "SidequestForCreate": {
        "type": "object",
        "required": [
          "event_id",
          "name",
          "description",
          "is_higher_result_better"
        ],
        "properties": {
          "description": {
            "type": "string"
          },
          "event_id": {
            "type": "string",
            "format": "uuid"
          },
          "is_higher_result_better": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "SidequestForPatch": {
        "type": "object",
        "required": ["event_id"],
        "properties": {
          "description": {
            "type": "string",
            "nullable": true
          },
          "event_id": {
            "type": "string",
            "format": "uuid"
          },
          "is_higher_result_better": {
            "type": "boolean",
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "TeamRole": {
        "type": "string",
        "enum": ["Member", "Mentor"]
      },
      "TimelineData": {
        "type": "object",
        "required": ["event_id", "scores"],
        "properties": {
          "end": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "event_id": {
            "type": "string",
            "format": "uuid"
          },
          "scores": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "array",
                "items": {
                  "allOf": [
                    {
                      "type": "string",
                      "format": "date-time"
                    },
                    {
                      "type": "integer",
                      "format": "int64"
                    }
                  ]
                }
              }
            }
          },
          "start": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        }
      },
      "UserForCreate": {
        "type": "object",
        "required": ["auth_id"],
        "properties": {
          "auth_id": {
            "type": "string"
          },
          "name": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "UserForPatch": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "UserRoles": {
        "type": "object",
        "required": ["event", "team"],
        "properties": {
          "event": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "$ref": "#/components/schemas/EventRole"
              },
              "uniqueItems": true
            }
          },
          "team": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "$ref": "#/components/schemas/TeamRole"
              },
              "uniqueItems": true
            }
          }
        }
      },
      "UserWithGroup": {
        "type": "object",
        "required": ["user_name", "group_name"],
        "properties": {
          "group_name": {
            "type": "string"
          },
          "user_name": {
            "type": "string"
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Hackathon Portal",
      "description": "Swagger for the Hackathon Dashboard by VIScon HackTech"
    }
  ]
}
