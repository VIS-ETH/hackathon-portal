# Backend

```bash
cargo run --package api --release
```

## Endpoints

| Name                                | Method | Path                                                                             | Policies                   | Description                                                          |
| ----------------------------------- | ------ | -------------------------------------------------------------------------------- | -------------------------- | -------------------------------------------------------------------- |
| get_me                              | GET    | /users/me                                                                        | -                          | Get the current user                                                 |
| update_me                           | PATCH  | /users/me                                                                        | -                          | Update the current user                                              |
|                                     |        |                                                                                  |                            |                                                                      |
| get_events                          | GET    | /events                                                                          | view_event (filter)        | Get all events                                                       |
| get_events_roles                    | GET    | /events/roles                                                                    | -                          | Get my roles on all events                                           |
| get_event_by_slug                   | GET    | /events/slug/:event_slug                                                         | view_event                 | Get event by slug                                                    |
| get_event                           | GET    | /events/:id                                                                      | view_event                 | Get event by id                                                      |
| update_event                        | PATCH  | /events/:id                                                                      | manage_event               | Update event                                                         |
| get_event_roles                     | GET    | /events/:id/roles                                                                | -                          | Get my roles on a specific event                                     |
| put_event_roles                     | PUT    | /events/:id/roles                                                                | manage_event               | Add role assignments                                                 |
| delete_event_roles                  | DELETE | /events/:id/roles                                                                | manage_event               | Remove role assignments                                              |
| invite_users                        | POST   | /events/:id/invite                                                               | manage_event               | Create users (if not existent) and add them with some role the event |
| get_event_affiliates                | GET    | /events/:id/affiliates?role=EventRole?                                           | view_event_internal        | Get all/filtered users on the event                                  |
| reindex_teams                       | POST   | /events/:id/teams/index                                                          | manage_event               | Re-calculate the index for each team                                 |
| get_projects_matching               | GET    | /events/:id/projects/matching                                                    | manage_event               | Get the matching of teams to projects based on the preferences       |
| get_sidequests_overview_leaderboard | GET    | /events/:id/sidequests/leaderboard                                               | view_event_internal        | Get the leaderboard for the sidequests                               |
| get_sidequests_team_leaderboard     | GET    | /events/:id/sidequests/team-leaderboard                                          | view_event_internal        | Get the leaderboard for the sidequests                               |
| get_sidequests_user_leaderboard     | GET    | /events/:id/sidequests/user-leaderboard                                          | view_event_internal        | Get the leaderboard for the sidequests                               |
| get_sidequests_history              | GET    | /events/:id/sidequests/history?before=DateTime?&after=DateTime?                  | view_event_internal        | Get the leaderboard for the sidequests                               |
|                                     |        |                                                                                  |                            |                                                                      |
| create_team                         | POST   | /teams                                                                           | create_team                | Create a team                                                        |
| get_teams                           | GET    | /teams?event_id=Uuid                                                             | view_event                 | Get all teams for an event                                           |
| get_teams_roles                     | GET    | /teams/roles?event_id=Uuid                                                       | -                          | Get my roles on all teams                                            |
| get_team_by_slug                    | GET    | /teams/slug/:event_slug/:team_slug                                               | get_event                  | Get team by slug                                                     |
| get_team                            | GET    | /teams/:id                                                                       | get_event                  | Get team by id                                                       |
| update_team                         | PATCH  | /teams/:id                                                                       | manage_team                | Update team                                                          |
| delete_team                         | DELETE | /teams/:id                                                                       | manage_team                | Delete team                                                          |
| get_team_roles                      | GET    | /teams/:id/roles                                                                 | manage_team                | Get my roles on a specific team                                      |
| put_team_roles                      | PUT    | /teams/:id/roles                                                                 | manage_team / manage_event | Add role assignments                                                 |
| delete_team_roles                   | DELETE | /teams/:id/roles                                                                 | manage_team / manage_event | Remove role assignments                                              |
| get_team_affiliates                 | GET    | /teams/:id/affiliates?role=TeamRole?                                             | view_event_internal        | Get all/filtered users on the team                                   |
| update_team_project                 | PATCH  | /teams/:id/project                                                               | manage_event               | Set a team's project assignment                                      |
| get_team_project_preferences        | GET    | /teams/:id/project-preferences                                                   | view_team_confidential     | Get a team's project preferences (3 distinct project ids)            |
| update_team_project_preferences     | PATCH  | /teams/:id/project-preferences                                                   | manage_team                | Set a team's project preferences (3 distinct project ids)            |
| get_team_password                   | GET    | /teams/:id/password                                                              | view_team_confidential     | Get a team's password                                                |
| update_team_password                | PATCH  | /teams/:id/password                                                              | manage_event               | Set a team's password                                                |
|                                     |        |                                                                                  |                            |                                                                      |
| create_project                      | POST   | /projects                                                                        | manage_project             |                                                                      |
| get_projects                        | GET    | /projects?event_id=Uuid                                                          | view_event                 |                                                                      |
| get_project_by_slug                 | GET    | /projects/slug/:event_slug/:project_slug                                         | view_event                 |                                                                      |
| get_project                         | GET    | /projects/:id                                                                    | view_event                 |                                                                      |
| update_project                      | PATCH  | /projects/:id                                                                    | manage_project             |                                                                      |
| delete_project                      | DELETE | /projects/:id                                                                    | manage_project             |                                                                      |
|                                     |        |                                                                                  |                            |                                                                      |
| create_sidequest                    | POST   | /sidequests                                                                      | manage_sidequest           |                                                                      |
| get_sidequests                      | GET    | /sidequests?event_id=Uuid                                                        | view_event_internal        |                                                                      |
| get_sidequest_by_slug               | GET    | /sidequests/slug/:event_slug/:sidequest_slug                                     | view_event_internal        |                                                                      |
| get_sidequest                       | GET    | /sidequests/:id                                                                  | view_event_internal        |                                                                      |
| update_sidequest                    | PATCH  | /sidequests/:id                                                                  | manage_sidequest           |                                                                      |
| delete_sidequest                    | DELETE | /sidequests/:id                                                                  | manage_sidequest           |                                                                      |
|                                     |        |                                                                                  |                            |                                                                      |
| create_sidequest_attempt            | POST   | /sidequest-attempts                                                              | manage_sidequest           |                                                                      |
| get_sidequest_attempts              | GET    | /sidequest-attempts?event_id=Uuid&sidequest_id=Uuid?&team_id=Uuid?&user_id=Uuid? | view_sidequest_attempt     |                                                                      |
| get_sidequest_attempt_cooldown      | GET    | /sidequest-attempts/cooldown?event_id=Uuid&user_id=Uuid?                         | view_sidequest_attempt / - | Get the latest attempt of a user                                     |
| get_sidequest_attempt               | GET    | /sidequest-attempts/:id                                                          | view_sidequest_attempt     |                                                                      |
| update_sidequest_attempt            | PATCH  | /sidequest-attempts/:id                                                          | manage_sidequest           |                                                                      |
| delete_sidequest_attempt            | DELETE | /sidequest-attempts/:id                                                          | manage_sidequest           |                                                                      |
|                                     |        |                                                                                  |                            |                                                                      |
| create_appointment                  | POST   | /appointments                                                                    | manage_event               |                                                                      |
| get_appointments                    | GET    | /appointments?event_id=Uuid                                                      | view_event_internal        |                                                                      |
| get_appointment                     | GET    | /appointments/:id                                                                | view_event_internal        |                                                                      |
| update_appointment                  | PATCH  | /appointments/:id                                                                | manage_event               |                                                                      |
| delete_appointment                  | DELETE | /appointments/:id                                                                | manage_event               |                                                                      |
